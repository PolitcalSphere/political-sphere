import{_ as a,c as i,o as t,ae as s}from"./chunks/framework.CBTkueSR.js";const p=JSON.parse('{"title":"Disaster Recovery Plan","description":"","frontmatter":{},"headers":[],"relativePath":"runbooks/dr-plan.md","filePath":"runbooks/dr-plan.md"}'),r={name:"runbooks/dr-plan.md"};function o(n,e,l,c,d,h){return t(),i("div",null,[...e[0]||(e[0]=[s(`<h1 id="disaster-recovery-plan" tabindex="-1">Disaster Recovery Plan <a class="header-anchor" href="#disaster-recovery-plan" aria-label="Permalink to &quot;Disaster Recovery Plan&quot;">​</a></h1><p>This DR plan outlines how to recover Political Sphere infrastructure and applications in the event of catastrophic failure or data loss.</p><h2 id="objectives" tabindex="-1">Objectives <a class="header-anchor" href="#objectives" aria-label="Permalink to &quot;Objectives&quot;">​</a></h2><ul><li><strong>RTO</strong> (Recovery Time Objective): 4 hours for critical services (API, frontend, auth).</li><li><strong>RPO</strong> (Recovery Point Objective): 15 minutes for databases (RDS PITR) and 1 hour for object storage (S3 versioning).</li></ul><h2 id="assumptions" tabindex="-1">Assumptions <a class="header-anchor" href="#assumptions" aria-label="Permalink to &quot;Assumptions&quot;">​</a></h2><ul><li>Terraform remote state persists in S3 bucket with versioning.</li><li>RDS automated backups and manual snapshots are available.</li><li>ECR stores current container images.</li><li>Helm charts and manifests remain in Git (GitOps source of truth).</li></ul><h2 id="recovery-phases" tabindex="-1">Recovery Phases <a class="header-anchor" href="#recovery-phases" aria-label="Permalink to &quot;Recovery Phases&quot;">​</a></h2><h3 id="_1-assess-impact" tabindex="-1">1. Assess Impact <a class="header-anchor" href="#_1-assess-impact" aria-label="Permalink to &quot;1. Assess Impact&quot;">​</a></h3><ul><li>Identify failed region/service. Determine whether failover to another AWS region or account is required.</li><li>Validate health checks: Argo CD, Prometheus, Grafana, RDS, Redis.</li></ul><h3 id="_2-failover-decision" tabindex="-1">2. Failover Decision <a class="header-anchor" href="#_2-failover-decision" aria-label="Permalink to &quot;2. Failover Decision&quot;">​</a></h3><ul><li>If single component failure (e.g., RDS), perform same-region restore.</li><li>If regional outage, initiate cross-region recovery using Terraform environment overlays targeting secondary region.</li></ul><h3 id="_3-infrastructure-restoration" tabindex="-1">3. Infrastructure Restoration <a class="header-anchor" href="#_3-infrastructure-restoration" aria-label="Permalink to &quot;3. Infrastructure Restoration&quot;">​</a></h3><ol><li>Clone infrastructure repo; checkout last known good tag.</li><li>Update backend config to point to recovery state bucket/table if original is compromised.</li><li>Apply Terraform in desired environment:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> infrastructure/envs/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">en</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terraform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -reconfigure</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terraform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span></span></code></pre></div></li><li>For RDS, choose restore method: <ul><li><strong>Point-in-Time Restore</strong>: create new instance from latest snapshot; update Terraform variables with new identifier.</li><li><strong>Cross-Region Restore</strong>: use snapshot copy in target region, update DNS cutover once ready.</li></ul></li><li>Restore Redis cache (if needed) from snapshot or allow to warm up from application.</li><li>Validate Route53 records, ACM certificates (reissue if region changed).</li></ol><h3 id="_4-application-deployment" tabindex="-1">4. Application Deployment <a class="header-anchor" href="#_4-application-deployment" aria-label="Permalink to &quot;4. Application Deployment&quot;">​</a></h3><ul><li>Argo CD: update cluster credentials/OIDC if EKS changed, then sync <code>platform-core</code> and workloads.</li><li>Verify namespaces, network policies, and RBAC enforcement.</li><li>Ensure secrets are restored (Vault/Secrets Manager). If secrets were lost, re-bootstrap via <code>scripts/bootstrap-vault.sh</code> (future work).</li></ul><h3 id="_5-data-validation" tabindex="-1">5. Data Validation <a class="header-anchor" href="#_5-data-validation" aria-label="Permalink to &quot;5. Data Validation&quot;">​</a></h3><ul><li>Run application smoke tests (see <code>docs/templates/smoke-test-checklist.md</code>).</li><li>Validate database integrity (run migrations, sample queries).</li><li>Confirm S3 objects accessible (spot-check critical assets).</li></ul><h3 id="_6-cutover" tabindex="-1">6. Cutover <a class="header-anchor" href="#_6-cutover" aria-label="Permalink to &quot;6. Cutover&quot;">​</a></h3><ul><li>Update DNS records or load balancer targets to point to recovered environment.</li><li>Inform stakeholders that services are back online; monitor metrics for 1 hour before standing down.</li></ul><h2 id="backups-testing" tabindex="-1">Backups &amp; Testing <a class="header-anchor" href="#backups-testing" aria-label="Permalink to &quot;Backups &amp; Testing&quot;">​</a></h2><ul><li><strong>RDS</strong>: Automated backups daily; keep last 7 days (dev) / 35 days (prod). Schedule quarterly restore drills.</li><li><strong>S3</strong>: Enable versioning + lifecycle policies (already configured in Terraform). Quarterly restore test.</li><li><strong>Terraform State</strong>: S3 bucket uses versioning; DynamoDB lock table ensures consistency.</li><li><strong>Artifacts</strong>: ECR retain 150 image versions; consider replicating to disaster region (set <code>ecr_replication_rules</code>).</li></ul><h2 id="communication" tabindex="-1">Communication <a class="header-anchor" href="#communication" aria-label="Permalink to &quot;Communication&quot;">​</a></h2><ul><li>Use <code>#incidents</code> channel for coordination.</li><li>Escalate to leadership for SEV0/SEV1 events.</li><li>Provide recovery ETA updates every 30 minutes.</li></ul><h2 id="follow-up" tabindex="-1">Follow-Up <a class="header-anchor" href="#follow-up" aria-label="Permalink to &quot;Follow-Up&quot;">​</a></h2><ul><li>Document DR activation in postmortem.</li><li>Update DR plan with lessons learned.</li><li>File action items for missing automation (e.g., automated DNS failover, cross-region replication).</li></ul>`,25)])])}const m=a(r,[["render",o]]);export{p as __pageData,m as default};
